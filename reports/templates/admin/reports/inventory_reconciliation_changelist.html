{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'admin/css/changelists.css' %}">
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% translate 'Home' %}</a>
    › <span>Reports</span>
    › <span>Inventory Reconciliation</span>
</div>
{% endblock %}

{% block content %}
<div id="content-main" class="module">
    <h1>Inventory Reconciliation</h1>

    <div class="object-tools">
        <ul class="object-tools">
            <li>
                <a href="{% url download_url_name %}">
                    Download CSV
                </a>
            </li>
        </ul>
    </div>

    <p>
        This report compares:
    </p>
    <ul>
        <li>
            <strong>ItemModel snapshot</strong>  
            (inventory_received, inventory_received_value, avg cost saved on each Item)
        </li>
        <li>
            <strong>Transaction history reality</strong>  
            (qty received from Bills, qty sold on Invoices, on-hand, on-hand value)
        </li>
    </ul>

    <p>
        The CSV includes delta columns:
        <code>delta_received_qty</code> and <code>delta_received_value</code>.
        If those are not zero, that item was damaged by the recount
        and needs to be fixed in Item Model.
    </p>

    <p>
        After you download and open the CSV in Excel:
        <br>
        - Sort by the delta columns<br>
        - For each item with a non-zero delta,<br>
        &nbsp;&nbsp;go to Admin → Django Ledger → Item models → pick that item<br>
        &nbsp;&nbsp;and restore <strong>inventory_received</strong> and
        <strong>inventory_received_value</strong> to what the CSV shows under
        <em>qty_received_txn</em> and <em>cost_received_txn</em>.
    </p>

</div>
{% endblock %}
